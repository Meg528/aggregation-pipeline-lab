"use strict";(self.webpackChunkaggregation_pipeline_workshop=self.webpackChunkaggregation_pipeline_workshop||[]).push([[530],{1745:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>c});var s=i(5893),t=i(1151);const l={},o="$project",r={id:"simple-queries/project",title:"$project",description:"Including fields in a projection",source:"@site/docs/30-simple-queries/3-project.mdx",sourceDirName:"30-simple-queries",slug:"/simple-queries/project",permalink:"/aggregation-pipeline-lab/docs/simple-queries/project",draft:!1,unlisted:!1,editUrl:"https://github.com/mongodb-developer/aggregation-pipeline-lab/blob/main/docs/30-simple-queries/3-project.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"$match",permalink:"/aggregation-pipeline-lab/docs/simple-queries/match"},next:{title:"$limit",permalink:"/aggregation-pipeline-lab/docs/simple-queries/limiting-results"}},d={},c=[{value:"Including fields in a projection",id:"including-fields-in-a-projection",level:2},{value:"Excluding fields",id:"excluding-fields",level:2},{value:"Including and excluding fields",id:"including-and-excluding-fields",level:2}];function a(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.a)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"project",children:"$project"}),"\n",(0,s.jsx)(n.h2,{id:"including-fields-in-a-projection",children:"Including fields in a projection"}),"\n",(0,s.jsxs)(n.p,{children:["A document from the ",(0,s.jsx)(n.code,{children:"books"})," collection looks like:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"{\n  _id: '0395623650',\n  title: 'Platero y yo / Platero and I (Spanish-English Bilingual Edition) (English and Spanish Edition)',\n  authors: [\n    {\n      _id: '64cc2db4830ba29148db5180',\n      name: 'Juan Ram\xf3n Jim\xe9nez'\n    }\n  ],\n  pages: 64,\n  year: 1994,\n  synopsis: 'Selections from a classic of world literature present a picture of life in the town of Moguer, in Andalusia, Spain.\\n' +\n    '\\n' +\n    '\\n' +\n    '                        Presents a picture of life in the town of Moguer, in Andalusia, Spain, as seen through the eyes of a wandering poet and his faithful donkey.\\n',\n  cover: 'https://images.isbndb.com/covers/36/57/9780395623657.jpg',\n  attributes: [\n    {\n      key: 'edition',\n      value: 'F First Edition Thus'\n    },\n    {\n      key: 'dimensions',\n      value: 'Height: 10.499979 Inches, Length: 6.999986 Inches, Weight: 2.0502990366 Pounds, Width: 0.12499975 Inches'\n    },\n    {\n      key: 'isbn13',\n      value: '9780395623657'\n    },\n    {\n      key: 'msrp',\n      value: 1.99\n    },\n    {\n      key: 'isbn',\n      value: '0395623650'\n    },\n    {\n      key: 'isbn10',\n      value: '0395623650'\n    }\n  ],\n  totalInventory: 1,\n  available: 1,\n  binding: 'Hardcover',\n  language: 'en',\n  longTitle: 'Platero y yo / Platero and I (Spanish-English Bilingual Edition) (English and Spanish Edition)',\n  publisher: 'Clarion Books'\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If we're interested just in the titles, we can use ",(0,s.jsx)(n.code,{children:"$project"})," to select just the fields we're interested in. As an example, to get just the book's title and year we'll write:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"db.books.aggregate([{$project: {title: 1, year: 1}}])\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'1 means "show that field"'}),"\n",(0,s.jsx)(n.li,{children:'0 means "hide that field"'}),"\n",(0,s.jsxs)(n.li,{children:["the primary key ",(0,s.jsx)(n.code,{children:"_id"})," field is shown by default"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["So we can exclude fields and show all fields except ",(0,s.jsx)(n.code,{children:"attributes"})," using:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"db.books.aggregate([{$project: {attributes: 0}}])\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\ud83d\udcbb Show only ",(0,s.jsx)(n.code,{children:"title"})," and ",(0,s.jsx)(n.code,{children:"cover"}),"."]}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Answer"}),(0,s.jsx)("div",{children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"db.books.aggregate([{$project: {title:1, cover: 1}}])\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"excluding-fields",children:"Excluding fields"}),"\n",(0,s.jsxs)(n.p,{children:["\ud83d\udcbb Exclude the ",(0,s.jsx)(n.code,{children:"cover"}),", ",(0,s.jsx)(n.code,{children:"attributes"})," and ",(0,s.jsx)(n.code,{children:"_id"})," fields from the result."]}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Answer"}),(0,s.jsx)("div",{children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"db.books.aggregate([{$project: {_id :0, attributes: 0, cover: 0}}])\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"including-and-excluding-fields",children:"Including and excluding fields"}),"\n",(0,s.jsx)(n.admonition,{type:"danger",children:(0,s.jsx)(n.p,{children:"You can't include and exclude fields in the same projection: if you start including, you must keep including and vice versa."})}),"\n",(0,s.jsx)(n.p,{children:"For instance, this will fail:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"db.books.aggregate([{$project: {title:1, attributes: 0}}])\n\nMongoServerError: Invalid $project :: caused by :: Cannot do exclusion on field attributes in inclusion projection\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["The only exception to this rule is the ",(0,s.jsx)(n.code,{children:"_id"})," field, which we can exclude in an inclusion projection"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"db.books.aggregate([{$project: {title:1, _id: 0}}])\n"})})]})}function u(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},1151:(e,n,i)=>{i.d(n,{Z:()=>r,a:()=>o});var s=i(7294);const t={},l=s.createContext(t);function o(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);